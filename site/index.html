<html>
  <head>
    <link rel="stylesheet" type="text/css" href="stylesheets/jplayer.blue.monday.css" />
    <link rel="stylesheet" type="text/css" href="stylesheets/motel.css" />
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>
    <script type="text/javascript" src="javascripts/rjr/json.js"></script>
    <script type="text/javascript" src="javascripts/rjr/jrw.js"></script>
    <script type="text/javascript" src="javascripts/jquery.cookie.js"></script>
    <script type="text/javascript" src="javascripts/jquery.jplayer.min.js"></script>
    <script type="text/javascript" src="javascripts/jquery.jplayer.playlist.min.js"></script>
    <script type="text/javascript" src="javascripts/user.js"></script>
    <script type="text/javascript" src="javascripts/location.js"></script>
    <script type="text/javascript" src="javascripts/input.js"></script>
    <script type="text/javascript" src="javascripts/handler.js"></script>
    <script type="text/javascript" src="javascripts/client.js"></script>
    <script type="text/javascript" src="javascripts/draw.js"></script>
    <script type="text/javascript" src="javascripts/audio.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){ 
        // right now browser compatability check is restricted
        // to the platform I tested all this on.
        // Want expanded support?
        // Test this out in alternative browsers and send patches!
        var user_agent = $.browser;
        if(!user_agent.mozilla || user_agent.version < "8.0"){
          alert("Must be running Firefox >= 8.0");
          return;
        }

        handlers = new OmegaHandlers();
        handlers.onopen = function(){
          client.current_user.restore_session(client);
        }
        handlers.onlogin = function(){
          handlers.clear_callbacks();
          handlers.add_callback(handlers.handle_galaxies);
          handlers.add_callback(handlers.handle_ships);
          handlers.add_callback(handlers.handle_stations);
          handlers.add_callback(handlers.populate_locations_container);
          handlers.add_callback(handlers.populate_fleets_container);
          handlers.add_callback(handlers.populate_alliances_container);
          handlers.add_method('on_movement', handlers.on_movement);
          handlers.add_method('users::on_message', handlers.on_message);

          client.get_cosmos_entity('galaxy');
          client.get_entities_for_user(client.current_user.id, 'Manufactured::Fleet');
          client.get_user_info();
          client.subscribe_to_messages();
          controls.show_logout_controls();
        }
        handlers.onlogout = function(){
          controls.show_login_controls();
        }
        handlers.add_error_handler(handlers.print_error_to_console);
        handlers.add_error_handler(handlers.show_error);

        controls = new CosmosControls();
        client = new CosmosClient();
        client.connect();

        ui = new CosmosUI();
        setInterval(ui.draw, 500);
      });
    </script>
  </head>
  <body>
    <div id="login_logout_link">
      <a href="#" id="create_account_dialog_link">register</a>
      <a href="/wotel/account.html" id="account_link" style="display: none">account</a> /
      <a href="#" id="login_dialog_link">login</a>
      <a href="#" id="logout_link" style="display: none">logout</a>
    </div>

    <div id="primary_navigation">
      <a href="/wiki/Omegaverse:About">About</a>
      <a href="/wiki/Omegaverse">Wiki</a>
      <a href="/wiki/Forum">Forums</a>
      <a href="/stats.html">Stats</a>
    </div>

    <div id="motel_entities_container">
      <div id="motel_locations_container" class="motel_entities_subcontainer"></div>
      <div id="motel_fleets_container" class="motel_entities_subcontainer"></div>
      <div id="motel_alliances_container" class="motel_entities_subcontainer"></div>
    </div>

    <div id="motel_canvas_container">
      <canvas id="motel_canvas" width="1000" height="700"></canvas>
    </div>

    <div id="motel_entity_container"></div>

    <div id="motel_dialog"></div>

    <div id="jquery_jplayer_1" class="jp-jplayer"></div>
    <div id="motel_jplayer_container" class="jp-audio">
      <div class="jp-type-playlist">
        <div id="jp_interface_1" class="jp-interface">
          <ul class="jp-controls">
              <li><a href="#" class="jp-play" tabindex="1">play</a></li>
              <li><a href="#" class="jp-pause" tabindex="1">pause</a></li>
              <li><a href="#" class="jp-stop" tabindex="1">stop</a></li>
              <li><a href="#" class="jp-next" tabindex="1">next</a></li>
              <li><a href="#" class="jp-mute" tabindex="1">mute</a></li>
              <li><a href="#" class="jp-unmute" tabindex="1">unmute</a></li>
          </ul>
          <div class="jp-volume-bar">
              <div class="jp-volume-bar-value"></div>
          </div>
          <div class="jp-progress">
              <div class="jp-seek-bar">
                  <div class="jp-play-bar"></div>
              </div>
          </div>
          <!--<div class="jp-current-time"></div>
          <div class="jp-duration"></div>-->
        </div>
        <div class="jp-playlist" style="display: none;"><ul><li></li></ul></div>
      </div>
    </div>

    <div id="motel_chat">
      <div id="motel_chat_input">
        $ <input type="text"></input>
        <input type="button" value="send"></input>
      </div>
      <div id="motel_chat_output">
        <textarea disabled="true"></textarea>
      </div>
    </div>
  </body>
</html>
